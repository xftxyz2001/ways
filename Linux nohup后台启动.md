## 一、nohup（no hung up）命令
nohup 语法格式：
```bash
nohup 命令 [参数]...
```

说明：
- 关闭客户端后，命令仍然会运行，不会挂断。
- nohup命令允许被运行的程序的输出信息将不会显示到终端。
- 默认情况下（非重定向时），会输出一个名叫 `nohup.out` 的文件到当前目录下，如果当前目录的 `nohup.out` 文件不可写，输出重定向到 `$HOME/nohup.out` 文件中。


## 二、nohup使用

### 2.1、nohup启动
```bash
nohup sh test.sh
```

说明：
- 后台启动 `test.sh` 脚本，日志默认会输出到当前目录的 `nohup.out` 文件

### 2.2、nohup与&，后台运行
`&` 符号表示将该命令或脚本放入后台运行。即 `&` 方式启动会有进程号，使用 `Ctrl` + `C` 程序不会中断，但终端关闭后运行会中断。
```bash
nohup sh test.sh &
```

### 2.3、nohup与>，日志重定向
上面提到的日志文件默认名称是 `nohup.out` ，如果修改日志文件的名称，则用到 重定向 ，符号是 `>` ，语法格式如下：
```bash
nohup sh test.sh >test.log
```

`>` 表示标准输出，还可以用 `>`, `>>`, `1>` 或 `1>>` 等进行表示

### 2.4、nohup后台启动-综合使用(推荐)
```bash
# 后台执行test.sh文件，将标准日志输出到output.log文件中，将错误日志也输出到output.log文件中
nohup ./test.sh > output.log 2>&1 &
# 等同于
nohup ./test.sh > output.log 2>output.log &
```

说明：
1. `>` 符号用于将命令的`标准输出`重定向到指定的文件中
2. `> outlog.log` 表示将终端输出保存到 `outlog.log` 文件中
3. `2>` 表示将命令的`标准错误`输出重定向到指定的文件中
4. `2>&1` 表示将命令的标准错误输出重定向到标准输出1中一起输出 （ps:标准输出1指的是 `>outlog.log` 文件，具体可见下面的内容）
5. `&` 后台挂起

**2>&1**
- `>` 符号用于将命令的标准输出重定向到指定的文件中，
- `2>` 表示将命令的标准错误输出重定向到指定的文件中，
- `2>&1` 表示将命令的标准错误输出重定向到标准输出中

### 2.5、nohup后台启动(不生成日志)
上面的示例中，都会将nohup执行的日志存放到nohup.out文件或者其他文件中，有没有方法不存放日志了呢？请使用以下命令
```bash
#/dev/null 表示空设备文件。如果不想输出任何的日志时，使用此参数。
nohup ./test.sh >/dev/null &
```


## 三、查看进程
```bash
nohup test.sh >out.log 2&1 &
```

```bash
ps -aux | grep "test.sh"
```

参数说明：
- a: 显示所有程序
- u: 以用户为主的格式来显示
- x: 显示所有程序，不区分终端机


## 四、知识扩展

### 4.1、不停止服务，直接清空nohup.out
如果脚本一直运行下去，nohup.out 日志会一直增长，日志但是硬盘容量有限，怎么把日志文件的大小减少？
注意，千万别直接删除日志文件，会造成服务无法输出日志，服务异常直接停止运行，这是最严重生产事故。

不停止服务，直接清空nohup.out文件有两种方法：

```bash
# 第1种：
cat /dev/null > nohup.out

# 第2种：
cp /dev/null nohup.out
```

### 4.2、只记录警告级别比较高的日志
输出的日志太多，nohup.out 增长特别快，对于不重要的日记，可以不记录，选择只记录警告级别比较高的日志。

```bash
# 只输出错误信息到日志文件，其它日志不输出
nohup ./test.sh > /dev/null 2>error.log &
```

### 4.3、不想输出日志
不想输出日志，什么日志都不要，只要服务能正常运行就行了。

```bash
# 什么日志也不输出
nohup ./test.sh > /dev/null 2>&1 &
```

---
- [Linux nohup后台启动/ 后台启动命令中nohup 、&、重定向的使用](https://blog.csdn.net/a1k2l45k/article/details/135151338)

